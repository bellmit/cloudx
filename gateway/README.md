### 网关服务
#### 特性
- 开箱即用
- 采用netkit异步框架，异步网络请求，任何后端慢响应均不会拖垮网关服务
- 配置驱动，职能参考nginx
- 支持反向代理
- 支持鉴权，路由转发，负载均衡，流量限速
- 支持二次开发，自定义后端协议转发
- 无状态，支持水平扩展
- 支持灰度，AB测
- 支持socks5代理请求到后端socks服务
- 支持某个配置key超过一定阀值时自动分配对应高流量线路做隔离
- 支持SPI动态加载自定义插件
- 支持聚合请求，参考nginx
- 支持同一业务根据不同的请求方法走不同的upstream，避免做到某些用户aid，某些url cmd请求分开隔离

#### 对业务方开发的二次开发
- 自定义拦截器实现有参数传递，包括自定义权限校验，事件机制校验等
- 自定义反向代理实现，包括聚合查询或者请求协议转换，统一用异步请求框架请求

#### 接口层统一接入网关的好处
- 实现统一的鉴权、监控和日志收集，后端微服务只实现业务，其他非业务相关的功能均不用操心
- 通过网关配置文件便能一眼识别出一个业务有多少微服务(location)，不需要找业务一个个收集，节省维护成本
- 业务方调用每个业务只需要知道业务网关IP实例，不需要知道所有其他微服务的IP实例，节省维护成本
- 网关在监控到后端压力时可以自动扩容后端微服务实例，实现负载自平衡
- 以业务为单位的请求均需要带APPID/SECRETID，便于统计每个请求的请求频率
- 相对nginx层的网关的区别，虽然性能略低于nginx，但java层网关基于java开发定制化更强，更加便捷且易招人维护

#### 劣势
- 中间加了一层代理，链路有所增加，且该网关服务需要具备高可用伸缩性强的服务
- WEB API网关项目在开发上是个串行任务，每暴露一个接口都需要去更新WEB API网关，如果同时有不同部门的需求去更新就会存在排队更新的情况，需要做到支持像nginx一样热加载配置文件

#### 架构设计
- 业务层调用接口不用关心哪些微服务需要对应哪些serviceId，统一用业务接口来调用，url做区分，例如会话产品则session.apposs.com/session,session.apposs.com/acct，网关再根据location来区分不同的seviceId调用
- 通过每个业务网关下面也能够知道每个业务下面有多少个微服务

#### 参考链接
- [Soul网关开源的前世今生](https://mp.weixin.qq.com/s/92TFLGy_q1e15W3kwtiSWw)
- [基于 Nacos 的网关灰度路由和服务权重灰度](https://mp.weixin.qq.com/s/fMZuQnXiejH7_N6R2Z76pA)
